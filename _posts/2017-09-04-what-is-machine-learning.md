---
layout: post
title: "머신러닝이란 무엇인가?"
date: 2017-09-04 09:00:00 +0900
categories: machine learning
tags: [machine learning, data science]
---

수아랩 리서치 블로그 첫 번째 글의 주제는 '머신러닝이란 무엇인가?' 입니다. AI(인공지능)를 가능하게 하는 핵심 기술이라고 할 수 있는 머신러닝에 대해서, 글을 읽는 모든 분들이 이해하실 수 있도록 최대한 쉬운 언어로 이야기를 풀어나가고자 합니다.

1. 본 글은 [저자의 개인 블로그](kilhokim.github.io) 글 <머신러닝이란 무엇인가?>에서 출발하여, 일부 내용을 추가, 수정하고 확장하였습니다.
2. 본문의 머신러닝 예시를 위해 작성한 Python 코드를 부록으로 함께 첨부하였습니다.

## 서론

**머신러닝(machine learning)**이 무엇일까요? 공학에 익숙하지 않으신 분들에게 대단한 위화감을 선사하는 이 영어 단어를 그대로 직역하면 '기계학습'입니다. 인간이 하나부터 열까지 직접 가르치는 기계를 의미하는 것이 아니라, 학습할 거리(?)를 일단 던져놓으면 이걸 가지고 스스로 학습하는 기계를 의미합니다.

> 러닝머신(running machine)과는 전혀 무관합니다.

그럼 기계를 왜 학습시킬까요? 사람이 할 수 있는(*혹은 할 수 없는*) 작업을 기계가 할 수 있도록 만들어서, 해당 작업을 아주 빠른 속도로 365일 24시간 내내 자동으로 수행하도록 하기 위함입니다. 어떻게 보면 특정 작업에 한해서는 사람보다 일을 훨씬 더 잘 하는 자그마한 AI를 탑재하는 과정으로 볼 수 있는데, 그러한 맥락에서 혹자들은 머신러닝을 약한 인공지능(weak AI)을 위한 기술이라고도 부릅니다. 

기계를 학습시켜 사람이 하는 일을 기계로 하여금 더 빨리, 더 오래 하도록 한다는 것은, 기업이나 국가의 입장에서 비용 절감을 위한 아주 매혹적인 대안이 아닐 수 없습니다. 수십 년 전까지만 하더라도 머신러닝을 통해 기계가 대체할 수 있는 일의 범위는 대단히 제한적이었는데, 21세기에 접어들면서 기술의 발전으로 인해 기계가 대체 가능한 영역이 점차적으로 확장되었고, 최근에 접어들어서는 '머신러닝을 통해 학습된 기계들이 인간의 일자리를 위협한다'는 말까지 돌아다닐 정도로 그 수준이 대단히 고도화되었습니다. 이로 인해 오늘날 전 세계의 수많은 기업 및 기관 등에서 머신러닝 기술을 어떻게든 적용하여 비용 절감을 도모해보고자 군침을 흘리고 있는 상황이라고 할 수 있습니다.

그러면 이제, 이렇게 핫한 머신러닝 기술을 이해하기 위해, 딱딱한 사전적 정의 대신 한 가지 친숙한 예시를 들면서 이야기를 시작하도록 하겠습니다.

### 유년 시절 단어 학습의 기억

여러분이 아주 어렸을 적, 꼬마 시절 기억을 떠올려봅시다. 여러분이 어느 대상의 개념을 처음 익힐 때를 기억하시나요? 말을 시작한 지 얼마 되지 않은 네살배기 꼬마 여러분이 어머니의 손을 붙잡고 공원으로 나간 상황을 가정해봅시다. 여러분을 둘러싼 주변의 수많은 대상들을 관찰하던 와중에, 여러분은 아래 그림과 같이 생긴 대상을 관찰하게 됩니다.

![나무의 전형적인 예시 사진]({{ site.url }}/assets/images/what-is-machine-learning/tree_example.png){: .center-image }

<center><i>나무의 전형적인 예시 사진</i></center>

저러한 대상을 관찰할 때만 하더라도 여러분은 저 대상이 무엇인지 몰랐는데, 어머니께 '엄마, 저게 뭐야?'라고 물어봤더니 어머니께서 '나무'라고 알려주셨습니다. 그런데, 실제로는 모든 나무가 위 그림처럼 생겼을 리가 없습니다. 나무도 그 종이 매우 다양하며, 동종의 나무라고 하더라도 자라온 환경에 따라 그 모양이 당연히 다를 수 있습니다. 따라서, 엄밀히 말하자면, 위 그림은 실제 '나무'라는 개념을 완전히 온전하게 설명해주진 못하며, '나무'라는 대상의 실체에 대하여 간접적으로 접근하여 관찰된 하나의 '**예시(example)**'에 불과하다고 할 수 있습니다. 꼬마 여러분들이 접한 나무 예시는 위의 저 그림밖에 없기 때문에, 여러분들의 머릿속에는 '나무 = 저것 그 자체'로 자리잡은 상태일 것입니다(언어적으로 풀어 설명하자면 '갈색의 딱딱하고 커다란 무언가가 하나 있고, 그 윗쪽으로 좀 더 얇은 무언가가 여러 개 뻗어있으며 각 가지에는 자잘하고 아주 얇은 녹색의 무언가가 여러 개 매달려 있는 대상' 따위가 되겠죠).

호기심이 많은 꼬마 여러분은, 이후에도 어머니를 따라 이곳저곳을 돌아다니면서 다양한 대상들을 더 관찰합니다. 그러면서 어머니께 시도때도 없이 질문합니다: '엄마, 저건 뭐야?' '응, 저것도 나무란다', '엄마, 이것도 나무야?' '응, 저건 나무가 아니란다' 등등 말이죠. 이와 같은 과정에서 여러분들은 '나무'의 다양한 예시들을 더 많이 접하게 되며, 여러분의 머릿속에서는 맨 처음 봤던 나무의 예시인 '갈색의 딱딱하고... 매달려 있는 대상'만이 존재하였던 상태에서, 나무의 예시들을 *확장적으로 받아들이면서* 동시에 '나무'라는 대상의 핵심이 되는 특질을 서서히 *압축해 나가게* 됩니다. 나무의 핵심 특질이 압축된 결과물이 여러분의 머릿속에서 추상적인 형태로 자리잡아 나가는 것입니다.

### 예시에 기반한 학습의 필요성

지식의 통용을 위해, 나무를 다년간 연구해 온 사람들은 이를 다음과 같이 언어적으로 *정의*하였습니다.

##### 나무[나무]

1. **줄기나 가지가 목질로 된 여러해살이 식물.**
2. 집을 짓거나 가구, 그릇 따위를 만들 때 재료로 사용하는 재목.
3. [같은 말] 땔나무(땔감이 되는 나무).

여러분이 이해했던 '나무'의 개념은 1번 정의에 가장 가까울 것입니다. 몇몇 분들은 위 정의를 보면서 이런 생각을 하실 수 있습니다: '처음부터 정의된 문장으로 나무의 개념을 학습한다면, 굳이 여러 개의 샘플을 접해가면서 나무의 개념을 확립해 나가고자 애를 쓰지 않아도 될 것 같은데?' 일견 일리가 있어 보이는 생각입니다. 그런데, 당연해 보일 수 있겠지만, 실제로는 꼬마 시절의 여러분의 머리로는 그게 될 리가 없습니다. 유아기 시절의 여러분은 '줄기'도, '가지'도, '목질'도, '여러해살이'도, '식물'조차도 무엇인지 모르는 상태입니다. 만약 여러분이 할 일이 없고 한가해서, '줄기'나 '가지'의 의미를 국어사전에서 계속 찾아나가면서 그 과정에서 새로 등장하는 단어들의 의미를 연이어 추적하고자 한다면, 아마도 머지않아 무한 반복의 함정에 빠져버린 자기 자신을 발견하게 될 것입니다.

> 국어사전에서는 '줄기'를 '고등 식물에 있어서 기본 기관의 하나. 식물체를 받치고 뿌리로부터 흡수한 수분이나 양분을 체관부, 물관부를 통하여 각 부에 나르는 역할을 한다.'라고 설명하고 있는데.. 고등 식물? 기관? 뿌리? 양분?? What the f#$k??

즉 다시 정리해보면, 추상적이거나 혹은 구체적인 실체가 있는 대상의 아주 기초적인 개념을 머릿속에 자리잡게 하기 위해서, 여러분들이 선택할 수 있는 최선의 방법은 그 대상을 나타내는 수많은 예시들을 받아들이면서 이를 여러분의 머릿속에서 압축된 형태로 정립해 나가도록 여러분의 뇌에 맡기는 것입니다.


## 머신러닝의 핵심 요소

왜 이렇게 뜬금없는(?) 이야기로 서론이 길었을까요? 머신러닝이 '기계를 학습시키는' 과정이, 여러분이 꼬마 시절 '나무'라는 대상의 개념을 익혔던 과정과 매우 흡사하기 때문입니다.

### 데이터

#### 예시1: 나무 여부 구별 기계

먼저, 꼬마인 여러분들을 학습시키기 위해 수많은 예시들이 필요했듯이, 기계를 학습시키기 위해서도 수많은 예시들이 필요합니다. 어느 컴퓨터로 하여금 매번 랜덤한 대상이 포함된 이미지(image)를 던져줬을 때, 그것이 '나무인지 아닌지'를 구별할 수 있도록 학습을 시키고자 한다고 가정해봅시다. 꼬마 시절 여러분들이 수많은 나무 예시들을 눈으로 관찰했듯이, 기계로 하여금 학습을 하도록 하려면 대단히 많은 수의 나무 이미지를 제시해줘야 합니다. 머신러닝에서는 이러한 수많은 **예시들의 집합**을 '**데이터(data)**'라고 부릅니다.

이 때 중요한 것은, 기계로 하여금 어느 대상의 이미지를 주고 그것이 나무인지 아닌지 구별하도록 하기 위해서는, 나무 이미지뿐만 아니라 나무가 아닌 이미지도 충분히 많이 제시해줘야 합니다. 따라서 실제로는 어느 랜덤한 이미지를 주고 {'나무', '나무X'} 중 하나의 표식을 붙여 그것의 정체를 나타내도록 하는데, 이를 '**레이블(label)**'이라고 합니다. 다시 말해, 머신러닝(정확히는 *지도 학습(supervised learning)* 패러다임에서의 머신러닝)에서는 수많은 (예시, 레이블) 쌍의 집합이 한 덩어리의 데이터가 되어 기계로 전달됩니다.

!['나무' vs '나무X' 데이터 - 예시와 레이블]({{ site.url }}/assets/images/what-is-machine-learning/treelike-things-with-labels.png)

<center><i>'나무' vs '나무X' 데이터 - 예시와 레이블의 나열</i></center>

#### 예시2: 3개월 내 채무 이행 여부 예측 기계

머신러닝은, 앞선 예시1에서의 '이미지를 보고 나무인지 아닌지 구별하는' 것처럼 사람이 쉽게 할 수 있는 작업을 기계로 하여금 할 수 있도록 하는 데 적용될 수 있습니다. 그런데, 어떤 수치화된 데이터에 대한 분석을 통해 최적의 의사결정을 내리는 것과 같이, 사람이 쉽고 빠르게 할 수 없는 작업에 대해서도 머신러닝이 적용될 수 있습니다. 기계 입장에서는 사실 이런 작업을 학습하는 것이 더 쉽습니다.

이렇게 수치화된 데이터에 기반한 의사결정과 관련된 다른 예시를 하나 들어 보겠습니다. 고객의 등골을 쪽쪽 빨아먹기로 악명 높은 대부업체인 '빨대론'에서는 수천명의 고객을 보유하고 있는데, 이들의 데이터를 바탕으로 하여 채무 이행 기한이 임박한 이들이 3개월 내에 채무를 이행할지/불이행할지 여부를 맞추고자 합니다. 머신러닝을 응용한 다년간의 연구 끝에 빨대론에서는 고객의 '나이'와 '연봉'정보만을 사용하여 해당 고객이 3개월 내로 채무를 이행할지 여부를 매우 높은 정확도로 예측하는 컴퓨터를 학습시키는 데 성공하였습니다(문제의 단순화를 위해 다소 과격한 가정을 하겠습니다).

머신러닝을 위해서는 먼저 데이터가 필요합니다. 컴퓨터로 하여금 나이와 연봉만을 주고 채무 이행 여부를 맞추도록 하기 위해서는 먼저 (예시, 레이블) 쌍의 집합으로 구성된 충분한 양의 데이터가 필요합니다. 빨대론의 경우, 예시에는 '나이와 연봉' 정보가 포함되어 있을 것이고, 레이블은 '채무 이행여부'가 될 것입니다.

좀 더 구체적인 예시를 들어봅시다. 데이터 확보를 위해, 빨대론에서는 과거에 3개월 내에 채무를 이행한 기록이 있거나, 혹은 이행하지 못한 기록이 있는 고객들의 데이터를 활용하고자 하였습니다. 예를 들어 2014년 3월 27일에 대출한 29세 '박갑부'씨는 연봉이 5천6백만원인데, 2014년 5월 31일에 채무를 이행한 기록이 있습니다. 한편 2015년 8월 10일에 대출한 33세 '최빈궁'씨는 연봉이 3천3백만원인데, 채무 이행 기한인 2015년 11월 9일까지 채무를 이행하지 못했다고 기록되어 있습니다. 빨대론에서는 이런 과거의 데이터를 모두 긁어모아 하나의 커다란 **데이터 집합(data set)**을 만들었습니다.

|---|---|---|---|
|번호|나이|연봉(백만원)|이행여부|
|---|---|---|---|
|1|29|56|O|
|2|64|89|O|
|3|33|17|X|
|4|45|94|O|
|5|24|26|X|
|6|55|24|X|
|7|35|52|O|
|8|57|65|O|
|9|45|32|X|
|10|52|75|O|
|11|62|31|X|

<center><i>빨대론의 고객 데이터 일부</i></center>

### 러닝 모델

다음으로 중요한 것이 사람으로 따지면 '뇌'에 해당하는 것인데, 머신러닝에서는 이를 '**러닝 모델(learning model)**'이라고 합니다. 러닝 모델은, 아주 간단히 말해서 하나의 커다란 함수로 구성되어 있다고 보면 됩니다. 여러분이 학창 시절 지식을 떠올려 보면, 대략 함수는 어떤 주어진 입력 변수에 대하여 특정한 연산을 수행한 결과를 출력 변수로 내뱉는 장치라고 배웠을 것입니다.

![함수의 모식도]({{ site.url }}/assets/images/what-is-machine-learning/function-diagram.png)

<center><i>함수의 모식도</i></center>

우리가 만들어내고자 하는 '나무 여부 구별 기계'의 경우에도, 이를 하나의 함수로 보아 단순화시키면, 입력 변숫값이 이미지이고 출력 변숫값이 {'나무', '나무X'} 중 하나인 함수라고 할 수 있습니다.

![나무인지 아닌지 구별하는 함수]({{ site.url }}/assets/images/what-is-machine-learning/image-to-istree-classifier.png)

<center><i>나무인지 아닌지 구별하는 함수</i></center>

한편 '3개월 내 채무 이행여부 예측 기계'의 경우, 입력 변숫값이 신규 고객의 '나이'와 '연봉'이고, 출력 변숫값이 {'이행', '이행X'} 중 하나인 함수라고 할 수 있습니다. 예를 들어 오늘 막 대출한 신규 고객 '김호구'씨가 있는데, 이 사람의 나이가 40세이고 연봉이 40백만원(=4천만원)일 때 향후 3개월 내로 채무를 이행할지 여부를 맞추는 것입니다.

![채무 이행여부 예측 함수]({{ site.url }}/assets/images/what-is-machine-learning/customer-data-to-fulfillment-classifier.png)

<center><i>채무 이행여부 예측 함수</i></center>

> 러닝 모델에 대해 이 이상으로 더 설명하려면, 좀 더 수학적인 설명을 하지 않을 수가 없습니다. 수학에 약하신 분들을 배려하여, 이 지점에서 미리 양해를 구합니다.

그럼 러닝 모델은 구체적으로 어떻게 생겼으며, 어떻게 학습되는 것일까요? 앞선 두 개의 예시를 붙들고 좀 더 자세히 접근해보도록 하겠습니다.

#### 예시2: 3개월 내 채무 이행 여부 예측 기계

앞서 빨대론의 11명 고객 데이터를 표로 나타내었는데, 표는 한 눈에 들어오지 않으므로 이를 플롯으로 찍어보도록 하겠습니다. 표기의 편의 상 나이를 $x_1$, 연봉을 $x_2$로 하고, 고객이 채무를 이행한 경우 해당 고객의 $(x_1, x_2)$ 좌표에 'O', 그렇지 않으면 'X'로 표기하도록 하겠습니다. 그럼 아래와 같은 플롯을 얻게 됩니다.

![X1-X2 그래프]({{ site.url }}/assets/images/what-is-machine-learning/age-to-salary-plot.png)

<center>*X1 - X2 그래프*</center>

